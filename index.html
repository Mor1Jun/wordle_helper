<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Wordle Helper</title>
    <!-- Load Tailwind CSS for styling -->
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        /* Use Inter font */
        body {
            font-family: "Inter", sans-serif;
        }
        /* Custom styles for the new guess boxes - (Replaced @apply with standard CSS) */
        .letter-box {
            width: 3rem; /* 48px */
            height: 3rem; /* 48px */
            display: flex;
            align-items: center;
            justify-content: center;
            text-align: center;
            font-size: 1.5rem; /* 24px */
            line-height: 2rem;
            font-weight: 700;
            text-transform: uppercase;
            border-width: 2px;
            border-radius: 0.375rem; /* 6px */
            --tw-shadow: 0 1px 2px 0 rgb(0 0 0 / 0.05);
            box-shadow: var(--tw-ring-offset-shadow, 0 0 #0000), var(--tw-ring-shadow, 0 0 #0000), var(--tw-shadow);
            cursor: pointer;
            transition-property: all;
            transition-timing-function: cubic-bezier(0.4, 0, 0.2, 1);
            transition-duration: 150ms;
        }
        @media (min-width: 640px) {
            .letter-box {
                width: 3.5rem; /* 56px */
                height: 3.5rem; /* 56px */
            }
        }
        /* State 0: Gray */
        .state-gray {
            border-color: #9CA3AF; /* gray-400 */
            background-color: #F3F4F6; /* gray-100 */
            color: #374151; /* gray-700 */
        }
        /* State 1: Yellow */
        .state-yellow {
            border-color: #F59E0B; /* yellow-500 */
            background-color: #FEF3C7; /* yellow-100 */
            color: #B45309; /* yellow-700 */
        }
        /* State 2: Green */
        .state-green {
            border-color: #10B981; /* green-500 */
            background-color: #D1FAE5; /* green-100 */
            color: #047857; /* green-700 */
        }
    </style>
</head>
<body class="bg-gray-50 min-h-screen p-4 sm:p-8 flex items-center justify-center">

    <div class="bg-white p-6 sm:p-8 rounded-2xl shadow-lg w-full max-w-2xl">
        
        <header class="text-center mb-6">
            <h1 class="text-3xl sm:text-4xl font-bold text-gray-800">Wordle Helper</h1>
            <p class="text-gray-600 mt-2">Enter your guesses below to filter the word list.</p>
            <!-- New status line for word list loading -->
            <p id="listStatus" class="text-lg text-gray-500 mt-4 text-center">Loading word list...</p>
        </header>
        
        <main>
            <!-- Word List section removed -->
            
            <!-- Step 1: Enter Guesses (Renumbered) -->
            <div class="mb-6">
                <label for="guessInput" class="block text-lg font-semibold text-gray-700 mb-2">1. Enter Your Guesses</label>
                <div class="flex gap-2 mb-4">
                    <input type="text" id="guessInput" maxlength="5" class="w-full p-3 border border-gray-300 rounded-lg shadow-sm focus:ring-2 focus:ring-blue-500 focus:border-blue-500 uppercase tracking-widest text-lg" placeholder="Type guess...">
                    <button id="submitGuessButton" class="bg-green-600 hover:bg-green-700 text-white font-bold py-3 px-5 rounded-lg shadow-md transition-all duration-200">
                        Submit
                    </button>
                </div>
                <!-- Guess history will be built here -->
                <div id="guessHistoryContainer" class="space-y-2">
                    <!-- Guesses are dynamically added here -->
                </div>
            </div>
            
            <!-- Action Buttons -->
            <div class="grid grid-cols-1 sm:grid-cols-3 gap-4 mb-6">
                <button id="filterButton" class="w-full bg-blue-600 hover:bg-blue-700 text-white font-bold py-3 px-6 rounded-lg shadow-md transition-all duration-200 text-lg">
                    Find Possible Words
                </button>
                <button id="undoButton" class="w-full bg-yellow-500 hover:bg-yellow-600 text-white font-bold py-3 px-6 rounded-lg shadow-md transition-all duration-200 text-lg">
                    Undo Guess
                </button>
                <button id="clearAllButton" class="w-full bg-red-600 hover:bg-red-700 text-white font-bold py-3 px-6 rounded-lg shadow-md transition-all duration-200 text-lg">
                    Clear All
                </button>
            </div>
            
            <!-- Results Section (Renumbered) -->
            <div class="mb-6">
                <h2 class="text-xl font-semibold text-gray-800 mb-3">
                    2. Results (<span id="resultCount">0</span>)
                </h2>
                <div id="results" class="h-64 p-4 bg-gray-100 border border-gray-200 rounded-lg overflow-y-auto text-gray-700 font-mono">
                    <!-- Results will be populated here -->
                </div>
            </div>

            <!-- Best Guess Section -->
            <div class="space-y-6">
                <!-- Box 1: Best Guess for Elimination (Old Logic) -->
                <div>
                    <h3 class="text-xl font-semibold text-gray-800 mb-3">Best Guess (for Elimination)</h3>
                    <div id="bestGuessElimination" class="p-4 bg-blue-100 border border-blue-300 rounded-lg text-blue-800 font-mono text-2xl text-center uppercase tracking-widest">
                        ---
                    </div>
                    <p class="text-sm text-gray-500 mt-2 text-center">This word is chosen to eliminate the most possibilities.</p>
                </div>

                <!-- Box 2: Best Guess for Winning (New Logic) -->
                <div>
                    <h3 class="text-xl font-semibold text-gray-800 mb-3">Best Guess (Potential Answer)</h3>
                    <div id="bestGuessWinner" class="p-4 bg-green-100 border border-green-300 rounded-lg text-green-800 font-mono text-2xl text-center uppercase tracking-widest">
                        ---
                    </div>
                    <p class="text-sm text-gray-500 mt-2 text-center">This word is the most likely answer from the results list.</p>
                </div>
            </div>
        </main>
    </div>

    <script>
// ... existing code ... -->
        const clearAllButton = document.getElementById('clearAllButton');
        const undoButton = document.getElementById('undoButton');
        const resultsDiv = document.getElementById('results');
        const resultCount = document.getElementById('resultCount');
        // Renamed and added new element
        const bestGuessEliminationDiv = document.getElementById('bestGuessElimination');
        const bestGuessWinnerDiv = document.getElementById('bestGuessWinner');
        
        // New reference for the list status
// ... existing code ... -->
        const guessInput = document.getElementById('guessInput');
        const submitGuessButton = document.getElementById('submitGuessButton');
        const guessHistoryContainer = document.getElementById('guessHistoryContainer');

// ... existing code ... -->
            // Check if word list is empty
            if (allWords.length === 0) {
                resultsDiv.textContent = 'Word list is not loaded. Please make sure Words.txt is in the repository.';
                resultCount.textContent = '0';
                bestGuessEliminationDiv.textContent = '---';
                bestGuessWinnerDiv.textContent = '---';
                return;
            }
            
// ... existing code ... -->
            } else {
                resultsDiv.textContent = 'No matching words found.';
            }

            // --- Find Best Guesses (Plural) ---
            findBestGuesses(allWords, possibleWords, allGreenLetters, allYellowLetters, grays);
        });

        /**
// ... existing code ... -->
        clearAllButton.addEventListener('click', () => {
            guessHistoryContainer.innerHTML = '';
            resultsDiv.innerHTML = '';
            resultCount.textContent = '0';
            bestGuessEliminationDiv.textContent = '---';
            bestGuessWinnerDiv.textContent = '---';
            guessInput.focus();
        });

// ... existing code ... -->
        });

        /**
         * Finds the best next guess. (Renamed to "findBestGuesses")
         * This now calls two separate functions for the two strategies.
         */
        function findBestGuesses(allWords, possibleWords, allGreenLetters, allYellowLetters, grays) {
            // Don't calculate if there are no words
            if (possibleWords.length === 0) {
                bestGuessEliminationDiv.textContent = '---';
                bestGuessWinnerDiv.textContent = '---';
                return;
            }

            // If only one word left, it's the answer
            if (possibleWords.length === 1) {
                bestGuessEliminationDiv.textContent = possibleWords[0];
                bestGuessWinnerDiv.textContent = possibleWords[0];
                return;
            }

            // --- 1. Calculate letter frequencies from the remaining *possible* words ---
            const letterFrequency = {};
            possibleWords.forEach(word => {
                const uniqueLetters = new Set(word.split(''));
                uniqueLetters.forEach(letter => {
                    letterFrequency[letter] = (letterFrequency[letter] || 0) + 1;
                });
            });

            // --- 2. Call the two different strategies ---
            findBestEliminator(allWords, letterFrequency, allGreenLetters, allYellowLetters, grays);
            findBestWinner(possibleWords, letterFrequency);
        }

        /**
         * Strategy 1: Find the best word from the *ENTIRE* list to eliminate possibilities.
         * (This is the old logic)
         */
        function findBestEliminator(allWords, letterFrequency, allGreenLetters, allYellowLetters, grays) {
            let bestGuess = { word: '', score: -1 };

            allWords.forEach(guessWord => {
                let score = 0;
                const uniqueLettersInGuess = new Set(guessWord.split(''));

                // First, check if this guessWord itself is valid (doesn't contain known grays)
                let isBadGuess = false;
                for (const grayChar of grays) {
                    if (!allGreenLetters.has(grayChar) && !allYellowLetters.has(grayChar) && guessWord.includes(grayChar)) {
                        isBadGuess = true;
                        break;
                    }
                }
                if (isBadGuess) return; // Skip this word, it's a bad guess

                // Calculate score based on letter frequency
                uniqueLettersInGuess.forEach(letter => {
                    // Only count letters that we haven't already found (green)
                    if (!allGreenLetters.has(letter)) {
                        score += letterFrequency[letter] || 0;
                    }
                });

                if (score > bestGuess.score) {
                    bestGuess = { word: guessWord, score: score };
                }
            });

            bestGuessEliminationDiv.textContent = bestGuess.word;
        }

        /**
         * Strategy 2: Find the "best" word from only the *POSSIBLE* answers.
         * (This is the new logic you wanted)
         */
        function findBestWinner(possibleWords, letterFrequency) {
            let bestGuess = { word: '', score: -1 };

            // Only score words from the remaining possibilities
            possibleWords.forEach(guessWord => {
                let score = 0;
                const uniqueLettersInGuess = new Set(guessWord.split(''));

                // Calculate score based on frequency *within the possible list*
                uniqueLettersInGuess.forEach(letter => {
                    score += letterFrequency[letter] || 0;
                });

                if (score > bestGuess.score) {
                    bestGuess = { word: guessWord, score: score };
                }
            });

            bestGuessWinnerDiv.textContent = bestGuess.word;
        }
    </script>
</body>
</html>

